@if (isVisible)
{
    <div class="video-player-panel position-fixed bottom-0 end-0 shadow-lg d-flex flex-column" 
         style="width: 420px; max-height: 400px; background-color: #f8f9fa; z-index: 1050; margin: 20px; border-radius: 8px; overflow: hidden;">
        <!-- Player Header -->
        <div class="bg-dark text-white p-2 d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-2">
                <i class="bi bi-play-circle-fill"></i>
                <span class="fw-bold small">Now Playing</span>
            </div>
            <button class="btn btn-sm btn-dark" @onclick="ClosePlayer" title="Close player">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        <!-- Channel Info -->
        <div class="flex-grow-1 overflow-auto p-3">
            <div class="mb-3">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <h6 class="mb-0 fw-bold">@channelName</h6>
                    <span class="badge @GetContentTypeBadgeClass()">
                        @GetContentTypeIcon() @contentType
                    </span>
                </div>
                
                <div class="mt-2">
                    <small class="text-muted d-block mb-1">Stream URL:</small>
                    <code class="d-block small text-break p-2 bg-light rounded" style="font-size: 0.7rem;">@streamUrl</code>
                </div>
            </div>

            <!-- Player Status -->
            <div class="alert alert-info mb-2 py-2">
                <div class="d-flex align-items-start gap-2">
                    <i class="bi bi-info-circle flex-shrink-0"></i>
                    <div>
                        <strong class="d-block small">External Player</strong>
                        <small class="d-block">Playing in VLC Media Player. The stream is being handled by an external application.</small>
                    </div>
                </div>
            </div>

            <!-- Player Instructions -->
            <div class="border-top pt-2">
                <h6 class="small text-muted mb-2">
                    <i class="bi bi-lightbulb"></i> Quick Tips
                </h6>
                <ul class="small mb-0" style="font-size: 0.8rem;">
                    <li>Click any channel to switch streams</li>
                    <li>Browse and search while playing</li>
                    <li>VLC controls playback volume and quality</li>
                    <li>Close this panel to stop playback</li>
                </ul>
            </div>
        </div>
    </div>
}

@code {
    private string GetContentTypeBadgeClass()
    {
        return contentType?.ToLower() switch
        {
            "live tv" => "bg-danger",
            "movie" => "bg-primary",
            "tv show" => "bg-success",
            _ => "bg-secondary"
        };
    }

    private string GetContentTypeIcon()
    {
        return contentType?.ToLower() switch
        {
            "live tv" => "üì∫",
            "movie" => "üé¨",
            "tv show" => "üì∫",
            _ => "‚ñ∂Ô∏è"
        };
    }
}
